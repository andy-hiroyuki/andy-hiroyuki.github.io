function addMusic(t){var a="";a+="<tr class='track' data-track_idx='"+t.track_idx+"'>",a+="<td class='right'>"+t.track_no+".</td>",a+="<td>"+t.title+"</td>",a+="<td>"+convertDuration(1e3*t.duration)+"</td>",a+="</tr>",$("#musiclist tbody").append(a)}function convertDuration(t){var a=String(Math.floor(t/36e5)+100).substring(1),r=String(Math.floor((t-36e5*a)/6e4)+100).substring(1),s=String(Math.round((t-36e5*a-6e4*r)/1e3)+100).substring(1),n=60*Number(a)+Number(r);return n+":"+s}soundManager.url="/swfs/",soundManager.flashVersion=9,soundManager.useFlashBlock=!1,soundManager.useHighPerformance=!0,soundManager.wmode="transparent",soundManager.useFastPolling=!0;var sc_tracks=new Array;$(function(){soundManager.onready(function(){$.getJSON(tracks_url,function(t){$.each(t,function(t,a){sc_tracks[t]={track_idx:t,track_no:t+1,track_id:"track_"+(t+1),title:a.title,duration:a.time,url:album_url+a.filename},soundManager.createSound({id:sc_tracks[t].track_id,url:sc_tracks[t].url,onplay:function(){$(".player").addClass("playing"),$(".title").text(sc_tracks[t].title)},onresume:function(){$(".player").addClass("playing")},onpause:function(){$(".player").removeClass("playing")},onfinish:function(){r()}})}),$(".title").text(sc_tracks[0].title);for(var a=0;a<sc_tracks.length;a++)addMusic(sc_tracks[a])})});var t="ontouchend"in document,a=t?"touchend":"mouseup";$(document).on(a,"#musiclist tr.track",function(){var t=$(this),a=t.data("track_idx"),r=sc_tracks[a],s=t.is(".active");s?(soundManager.pause(r.track_id),$("#ctrl-play").removeClass("pause")):(t.siblings("tr").hasClass("active")&&(soundManager.stopAll(),$("#ctrl-play").removeClass("pause")),soundManager.play(r.track_id),$("#ctrl-play").addClass("pause")),t.toggleClass("active").siblings("tr").removeClass("active")}),$(document).on(a,"#ctrl-play",function(){if(1==$("#musiclist tr.track").hasClass("active")){var t=$("#musiclist .active").data("track_idx");soundManager.togglePause(sc_tracks[t].track_id),$("#ctrl-play").toggleClass("pause")}else $("#musiclist tbody tr:first-child").trigger(a)}),$(document).on(a,"#ctrl-next",function(){r()}),$(document).on(a,"#ctrl-prev",function(){s()});var r=function(){soundManager.stopAll(),0==$("tr.track.active").next().trigger(a).length&&$("#musiclist tr.track:first-child").trigger(a)},s=function(){soundManager.stopAll(),0==$("tr.track.active").prev().trigger(a).length&&$("#musiclist tr.track:last-child").trigger(a)}});